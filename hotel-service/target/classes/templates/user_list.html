<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Менеджер пользователей</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-image: url('https://r4.wallpaperflare.com/wallpaper/533/163/784/digital-digital-art-artwork-illustration-minimalism-hd-wallpaper-d6caac3492787d76e8e36b4298facda4.jpg');
            background-size: cover;
            background-position: center;
        }

        .text-shadow {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
    </style>
    <link rel="stylesheet" href="/static/css/booking.css">
</head>
<body>
<div th:insert="~{/parts/dark_navbar_macro :: dark_navbar}"></div>
<div class="container main-content">
    <div class="d-flex mb-3 justify-content-center text-white flex-column align-items-center">
        <h1 class="text-shadow">Менеджер пользователей</h1>
        <h3 class="text-shadow">Управляйте учётными записями пользователей</h3>
        <h5 class="text-shadow">И не забывайте о безопасности</h5>
    </div>
    <form method="get" action="/admin/user" class="mb-3">
        <div class="input-group">
            <input type="text" class="form-control" id="username" name="username" placeholder="Введите почту" th:value="${username}">
            <button class="btn btn-primary" type="submit">Найти</button>
        </div>
    </form>

    <table class="table table-striped table-bordered table-dark">
        <thead class="thread-light">
        <tr>
            <th>
                Почта
                <a th:href="@{'/admin/user?page=' + ${currentPage} + '&sortBy=username&sortOrder=' + ${sortOrder == 'asc' ? 'desc' : 'asc'}}">
                    <span th:if="${sortBy == 'username' && sortOrder == 'asc'}">&#9650;</span>
                    <span th:if="${sortBy == 'username' && sortOrder == 'desc'}">&#9660;</span>
                </a>
            </th>
            <th>Роли</th>
            <th>Управление</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user : ${userPage.content}">
            <td th:text="${user.username}"></td>
            <td>
                <span th:each="role : ${user.roles}" th:text="${role}" th:if="${not #strings.isEmpty(role)}">
                    <span th:if="${role.first}">, </span>
                </span>
            </td>
            <td><a th:href="@{'user/' + ${user.id}}" class="btn btn-primary">Изменить</a></td>
        </tr>
        </tbody>
    </table>
    <nav aria-label="Page navigation" th:if="${totalPages > 0}">
        <ul class="pagination justify-content-center">
            <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                <a class="page-link" th:href="@{'/admin/user?page=' + ${currentPage - 1} + '&sortBy=' + ${sortBy} + '&sortOrder=' + ${sortOrder} + '&username=' + ${username}}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
                th:classappend="${i == currentPage} ? 'active'">
                <a class="page-link" th:href="@{'/admin/user?page=' + ${i} + '&sortBy=' + ${sortBy} + '&sortOrder=' + ${sortOrder} + '&username=' + ${username}}" th:text="${i + 1}"></a>
            </li>
            <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                <a class="page-link" th:href="@{'/admin/user?page=' + ${currentPage + 1} + '&sortBy=' + ${sortBy} + '&sortOrder=' + ${sortOrder} + '&username=' + ${username}}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>
<div th:insert="~{parts/footer_macro :: footer}"></div>
</body>
</html>